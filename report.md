# AdventureStay – Technical Report

## Architecture Overview

AdventureStay is split into three layers:

1. **Web/UI (Django)** – Handles routing, HTML rendering, ORM models, and data persistence.
2. **Domain Logic (`adventurestay-utils`)** – Validates booking requests, pricing, availability, and itinerary summaries.
3. **Cloud Integrations (AWS)** – Optional DynamoDB, S3, SQS, and SNS services triggered post-booking.

This separation mirrors the StayEase/accomm_utils_lib and TurfEase/turfslot-utils pattern, enforcing reuse of battle-tested business rules across delivery channels.

## Booking Flow

1. Visitor selects a package from `/packages/`.
2. `BookingForm` converts the Django model to the `AdventurePackage` dataclass.
3. Validators from `adventurestay-utils` enforce date and guest rules; availability is checked against existing bookings.
4. `AdventurePriceCalculator` computes the total price with weekend and peak-season multipliers.
5. Django saves the booking to SQLite (or the configured DB) and builds an itinerary summary.
6. AWS services persist the booking to DynamoDB and broadcast via SQS/SNS when `USE_AWS=1`. Otherwise, they log a fallback.
7. User lands on `/bookings/<id>/success/` showing the confirmation copy generated by `build_itinerary_summary`.

## AWS Fallback Strategy

Each service module checks `settings.USE_AWS` plus the relevant env vars. Missing configuration simply logs a message and skips the network call, enabling painless FOSS or local development without AWS credentials.

## Cloud Readiness

- Env-driven secrets, hostnames, and AWS resource identifiers.
- Static files separated for hosting behind a CDN.
- Requirements pin major versions and include the PyPI dependency for `adventurestay-utils`.
- `pytest-django` test ensures the booking flow remains intact as the UI evolves.

## Next Enhancements

- Extend service layer to store/read packages from DynamoDB for multi-region deployments.
- Add Celery tasks backing SQS consumption for asynchronous workflows.
- Build additional tests that mock AWS clients to assert payload structure when `USE_AWS=1`.
